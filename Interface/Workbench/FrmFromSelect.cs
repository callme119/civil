using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;

namespace Framework.Interface.Workbench
{
    public partial class FrmFromSelect : Framework.Interface.Common.FrmBase
    {
        public delegate void CreateModuleHandle(Framework.Entity.Template template, System.Collections.ArrayList array, object @class, object[] data);
        public CreateModuleHandle CreateModuleIntance;

        private Framework.Implement.ContentImpl contentService = new Framework.Implement.ContentImpl();
        private object @class;
        private Framework.Entity.Chapter chaptertemp;
        private System.Collections.ArrayList templateList1;

        public FrmFromSelect(Framework.Entity.Chapter chapter, object type)
        {
            InitializeComponent();
            @class = type;
            chaptertemp = chapter;

            templateList1 = contentService.GetContentTemplateByTitle(chapter.Title);
            if (chapter.Title == "²ÄÁÏÑ¡Ôñ")
            {
                st_FS_1.SelectedTabIndex = 0;
                btnAddRow.Visible = btnDeleteRow.Visible = false;
            }
            else if (chapter.Title == "ÈËÔ±°²ÅÅ")
            {
                st_FS_1.SelectedTabIndex = 1;
            }
            else {
                st_FS_1.SelectedTabIndex = 2;
            }
        }

        private void cB_FS_1DBZC_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (cB_FS_1DBZC.SelectedIndex == 0)//·½Ä¾
            {
                cB_FS_1JMLX.Enabled = false;
                dI_FS_1FMG.Enabled = dI_FS_1FMK.Enabled = true;
            }
            else if (cB_FS_1DBZC.SelectedIndex == 1)//·½¸Ö¹Ü
            {
                cB_FS_1JMLX.Enabled = true;
                dI_FS_1FMG.Enabled = dI_FS_1FMK.Enabled = false;
                cB_FS_1JMLX.Items.Clear();
                cB_FS_1JMLX.Items.Add("¡õ60¡Á40¡Á2.5"); cB_FS_1JMLX.Items.Add("¡õ80¡Á40¡Á2"); cB_FS_1JMLX.Items.Add("¡õ100¡Á50¡Á3");
            }
            else if (cB_FS_1DBZC.SelectedIndex == 2)//¹¤×Ö¸Ö
            {
                cB_FS_1JMLX.Enabled = true;
                dI_FS_1FMG.Enabled = dI_FS_1FMK.Enabled = false;
                cB_FS_1JMLX.Items.Clear();
                cB_FS_1JMLX.Items.Add("10ºÅ"); cB_FS_1JMLX.Items.Add("12.6ºÅ"); cB_FS_1JMLX.Items.Add("14ºÅ"); cB_FS_1JMLX.Items.Add("16ºÅ"); cB_FS_1JMLX.Items.Add("18ºÅ");
                cB_FS_1JMLX.Items.Add("20aºÅ"); cB_FS_1JMLX.Items.Add("20bºÅ"); cB_FS_1JMLX.Items.Add("22aºÅ"); cB_FS_1JMLX.Items.Add("22bºÅ"); cB_FS_1JMLX.Items.Add("25aºÅ");
                cB_FS_1JMLX.Items.Add("25bºÅ"); cB_FS_1JMLX.Items.Add("28aºÅ"); cB_FS_1JMLX.Items.Add("28bºÅ"); cB_FS_1JMLX.Items.Add("32aºÅ"); cB_FS_1JMLX.Items.Add("32bºÅ");
                cB_FS_1JMLX.Items.Add("32cºÅ"); cB_FS_1JMLX.Items.Add("36aºÅ"); cB_FS_1JMLX.Items.Add("36bºÅ"); cB_FS_1JMLX.Items.Add("36cºÅ"); cB_FS_1JMLX.Items.Add("40aºÅ");
                cB_FS_1JMLX.Items.Add("40bºÅ"); cB_FS_1JMLX.Items.Add("40cºÅ"); cB_FS_1JMLX.Items.Add("45aºÅ"); cB_FS_1JMLX.Items.Add("45bºÅ"); cB_FS_1JMLX.Items.Add("45cºÅ");
                cB_FS_1JMLX.Items.Add("50aºÅ"); cB_FS_1JMLX.Items.Add("50bºÅ"); cB_FS_1JMLX.Items.Add("50cºÅ"); cB_FS_1JMLX.Items.Add("56aºÅ"); cB_FS_1JMLX.Items.Add("56bºÅ");
                cB_FS_1JMLX.Items.Add("56cºÅ"); cB_FS_1JMLX.Items.Add("63aºÅ"); cB_FS_1JMLX.Items.Add("63bºÅ"); cB_FS_1JMLX.Items.Add("63cºÅ");
            }
            else if (cB_FS_1DBZC.SelectedIndex == 3)//²Û¸Ö
            {
                cB_FS_1JMLX.Enabled = true;
                dI_FS_1FMG.Enabled = dI_FS_1FMK.Enabled = false;
                cB_FS_1JMLX.Items.Clear();
                cB_FS_1JMLX.Items.Add("5ºÅ"); cB_FS_1JMLX.Items.Add("6.3ºÅ"); cB_FS_1JMLX.Items.Add("8ºÅ"); cB_FS_1JMLX.Items.Add("10ºÅ"); cB_FS_1JMLX.Items.Add("12.6ºÅ");
                cB_FS_1JMLX.Items.Add("14aºÅ"); cB_FS_1JMLX.Items.Add("14bºÅ"); cB_FS_1JMLX.Items.Add("16aºÅ"); cB_FS_1JMLX.Items.Add("16bºÅ"); cB_FS_1JMLX.Items.Add("18aºÅ");
                cB_FS_1JMLX.Items.Add("18bºÅ"); cB_FS_1JMLX.Items.Add("20aºÅ"); cB_FS_1JMLX.Items.Add("20bºÅ"); cB_FS_1JMLX.Items.Add("22aºÅ"); cB_FS_1JMLX.Items.Add("22bºÅ");
                cB_FS_1JMLX.Items.Add("25aºÅ"); cB_FS_1JMLX.Items.Add("25bºÅ"); cB_FS_1JMLX.Items.Add("25cºÅ"); cB_FS_1JMLX.Items.Add("28aºÅ"); cB_FS_1JMLX.Items.Add("28bºÅ");
                cB_FS_1JMLX.Items.Add("28cºÅ"); cB_FS_1JMLX.Items.Add("32aºÅ"); cB_FS_1JMLX.Items.Add("32bºÅ"); cB_FS_1JMLX.Items.Add("32cºÅ"); cB_FS_1JMLX.Items.Add("36aºÅ");
                cB_FS_1JMLX.Items.Add("36bºÅ"); cB_FS_1JMLX.Items.Add("36cºÅ"); cB_FS_1JMLX.Items.Add("40aºÅ"); cB_FS_1JMLX.Items.Add("40bºÅ"); cB_FS_1JMLX.Items.Add("40cºÅ");
            }
            else if (cB_FS_1DBZC.SelectedIndex == 4)//¸Ö¹Ü
            {
                cB_FS_1JMLX.Enabled = true;
                dI_FS_1FMG.Enabled = dI_FS_1FMK.Enabled = false;
                cB_FS_1JMLX.Items.Clear();
                cB_FS_1JMLX.Items.Add("¦Õ48¡Á3.5"); cB_FS_1JMLX.Items.Add("¦Õ48¡Á3.25"); cB_FS_1JMLX.Items.Add("¦Õ48¡Á3.2"); cB_FS_1JMLX.Items.Add("¦Õ48¡Á3"); cB_FS_1JMLX.Items.Add("¦Õ51¡Á3");
            }
        }

        private void cB_FS_2DBZC_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (cB_FS_2DBZC.SelectedIndex == 0)//·½Ä¾
            {
                cB_FS_2JMLX.Enabled = false;
                dI_FS_2FMG.Enabled = dI_FS_2FMK.Enabled = true;
            }
            else if (cB_FS_2DBZC.SelectedIndex == 1)//·½¸Ö¹Ü
            {
                cB_FS_2JMLX.Enabled = true;
                dI_FS_2FMG.Enabled = dI_FS_2FMK.Enabled = false;
                cB_FS_2JMLX.Items.Clear();
                cB_FS_2JMLX.Items.Add("¡õ60¡Á40¡Á2.5"); cB_FS_2JMLX.Items.Add("¡õ80¡Á40¡Á2"); cB_FS_2JMLX.Items.Add("¡õ100¡Á50¡Á3");
            }
            else if (cB_FS_2DBZC.SelectedIndex == 2)//¹¤×Ö¸Ö
            {
                cB_FS_2JMLX.Enabled = true;
                dI_FS_2FMG.Enabled = dI_FS_2FMK.Enabled = false;
                cB_FS_2JMLX.Items.Clear();
                cB_FS_2JMLX.Items.Add("10ºÅ"); cB_FS_2JMLX.Items.Add("12.6ºÅ"); cB_FS_2JMLX.Items.Add("14ºÅ"); cB_FS_2JMLX.Items.Add("16ºÅ"); cB_FS_2JMLX.Items.Add("18ºÅ");
                cB_FS_2JMLX.Items.Add("20aºÅ"); cB_FS_2JMLX.Items.Add("20bºÅ"); cB_FS_2JMLX.Items.Add("22aºÅ"); cB_FS_2JMLX.Items.Add("22bºÅ"); cB_FS_2JMLX.Items.Add("25aºÅ");
                cB_FS_2JMLX.Items.Add("25bºÅ"); cB_FS_2JMLX.Items.Add("28aºÅ"); cB_FS_2JMLX.Items.Add("28bºÅ"); cB_FS_2JMLX.Items.Add("32aºÅ"); cB_FS_2JMLX.Items.Add("32bºÅ");
                cB_FS_2JMLX.Items.Add("32cºÅ"); cB_FS_2JMLX.Items.Add("36aºÅ"); cB_FS_2JMLX.Items.Add("36bºÅ"); cB_FS_2JMLX.Items.Add("36cºÅ"); cB_FS_2JMLX.Items.Add("40aºÅ");
                cB_FS_2JMLX.Items.Add("40bºÅ"); cB_FS_2JMLX.Items.Add("40cºÅ"); cB_FS_2JMLX.Items.Add("45aºÅ"); cB_FS_2JMLX.Items.Add("45bºÅ"); cB_FS_2JMLX.Items.Add("45cºÅ");
                cB_FS_2JMLX.Items.Add("50aºÅ"); cB_FS_2JMLX.Items.Add("50bºÅ"); cB_FS_2JMLX.Items.Add("50cºÅ"); cB_FS_2JMLX.Items.Add("56aºÅ"); cB_FS_2JMLX.Items.Add("56bºÅ");
                cB_FS_2JMLX.Items.Add("56cºÅ"); cB_FS_2JMLX.Items.Add("63aºÅ"); cB_FS_2JMLX.Items.Add("63bºÅ"); cB_FS_2JMLX.Items.Add("63cºÅ");
            }
            else if (cB_FS_2DBZC.SelectedIndex == 3)//²Û¸Ö
            {
                cB_FS_2JMLX.Enabled = true;
                dI_FS_2FMG.Enabled = dI_FS_2FMK.Enabled = false;
                cB_FS_2JMLX.Items.Clear();
                cB_FS_2JMLX.Items.Add("5ºÅ"); cB_FS_2JMLX.Items.Add("6.3ºÅ"); cB_FS_2JMLX.Items.Add("8ºÅ"); cB_FS_2JMLX.Items.Add("10ºÅ"); cB_FS_2JMLX.Items.Add("12.6ºÅ");
                cB_FS_2JMLX.Items.Add("14aºÅ"); cB_FS_2JMLX.Items.Add("14bºÅ"); cB_FS_2JMLX.Items.Add("16aºÅ"); cB_FS_2JMLX.Items.Add("16bºÅ"); cB_FS_2JMLX.Items.Add("18aºÅ");
                cB_FS_2JMLX.Items.Add("18bºÅ"); cB_FS_2JMLX.Items.Add("20aºÅ"); cB_FS_2JMLX.Items.Add("20bºÅ"); cB_FS_2JMLX.Items.Add("22aºÅ"); cB_FS_2JMLX.Items.Add("22bºÅ");
                cB_FS_2JMLX.Items.Add("25aºÅ"); cB_FS_2JMLX.Items.Add("25bºÅ"); cB_FS_2JMLX.Items.Add("25cºÅ"); cB_FS_2JMLX.Items.Add("28aºÅ"); cB_FS_2JMLX.Items.Add("28bºÅ");
                cB_FS_2JMLX.Items.Add("28cºÅ"); cB_FS_2JMLX.Items.Add("32aºÅ"); cB_FS_2JMLX.Items.Add("32bºÅ"); cB_FS_2JMLX.Items.Add("32cºÅ"); cB_FS_2JMLX.Items.Add("36aºÅ");
                cB_FS_2JMLX.Items.Add("36bºÅ"); cB_FS_2JMLX.Items.Add("36cºÅ"); cB_FS_2JMLX.Items.Add("40aºÅ"); cB_FS_2JMLX.Items.Add("40bºÅ"); cB_FS_2JMLX.Items.Add("40cºÅ");
            }
            else if (cB_FS_2DBZC.SelectedIndex == 4)//¸Ö¹Ü
            {
                cB_FS_2JMLX.Enabled = true;
                dI_FS_2FMG.Enabled = dI_FS_2FMK.Enabled = false;
                cB_FS_2JMLX.Items.Clear();
                cB_FS_2JMLX.Items.Add("¦Õ48¡Á3.5"); cB_FS_2JMLX.Items.Add("¦Õ48¡Á3.25"); cB_FS_2JMLX.Items.Add("¦Õ48¡Á3.2"); cB_FS_2JMLX.Items.Add("¦Õ48¡Á3"); cB_FS_2JMLX.Items.Add("¦Õ51¡Á3");
            }
        }

        private void btnAddRow_Click(object sender, EventArgs e)
        {
            switch (st_FS_1.SelectedTabIndex)
            {
                case 1: Dgv_FS_Staff.Rows.Add(); break;
                case 2: Dgv_FS_Machine.Rows.Add(); break;
            }
        }

        private void FrmFromSelect_Load(object sender, EventArgs e)
        {
            #region //ÈËÔ±°²ÅÅ
            {
                DevComponents.DotNetBar.Controls.DataGridViewButtonXColumn colWorktypeChoice = new DevComponents.DotNetBar.Controls.DataGridViewButtonXColumn();
                colWorktypeChoice.HeaderText = "Ñ¡Ôñ¹¤ÖÖ";
                colWorktypeChoice.Width = 100;
                DevComponents.DotNetBar.Controls.DataGridViewTextBoxDropDownColumn colWorktype = new DevComponents.DotNetBar.Controls.DataGridViewTextBoxDropDownColumn();
                colWorktype.HeaderText = "¹¤ÖÖÃû³Æ";
                colWorktype.Width = 180;
                DevComponents.DotNetBar.Controls.DataGridViewIntegerInputColumn colWorkNumber = new DevComponents.DotNetBar.Controls.DataGridViewIntegerInputColumn();
                colWorkNumber.HeaderText = "ÈËÊý";
                colWorkNumber.Width = 180;
                DevComponents.DotNetBar.Controls.DataGridViewCheckBoxXColumn colWorkDelete = new DevComponents.DotNetBar.Controls.DataGridViewCheckBoxXColumn();
                colWorkDelete.HeaderText = "É¾³ýÐÐ";
                colWorkDelete.Width = 60;
                Dgv_FS_Staff.Columns.Add(colWorktypeChoice);
                Dgv_FS_Staff.Columns.Add(colWorktype);
                Dgv_FS_Staff.Columns.Add(colWorkNumber);
                Dgv_FS_Staff.Columns.Add(colWorkDelete);
                Dgv_FS_Staff.Rows.Add();

                object[] strWork = new object[] { "¼¼Êõ¹ÜÀí", "°²È«¼à¶½", "ÖÊÁ¿¼ì²â", "²âÁ¿·ÅÏß", "¼Ü×Ó¹¤", "µçº¸¹¤", "Ä¾¹¤", "ÐÞÀí¹¤", "»ìÄýÍÁ¹¤", "¸Ö½î¹¤" };
                for (int i = 0; i < strWork.Length; i++)
                {
                    DevComponents.DotNetBar.ButtonItem btnItem = new DevComponents.DotNetBar.ButtonItem();
                    btnItem.Text = (string)strWork[i];
                    btnItem.Click += new System.EventHandler(delegate(object sender1, System.EventArgs args)
                    {
                        int RowNum = Dgv_FS_Staff.CurrentRow.Index;
                        Dgv_FS_Staff.Rows[RowNum].Cells[1].Value = btnItem.Text;
                        Dgv_FS_Staff.Refresh();
                    });
                    colWorktypeChoice.SubItems.Add(btnItem);
                }
            }
            #endregion

            #region //»úÐµ°²ÅÅ±í
            {
                DevComponents.DotNetBar.Controls.DataGridViewButtonXColumn colMaterialChoice = new DevComponents.DotNetBar.Controls.DataGridViewButtonXColumn();
                colMaterialChoice.HeaderText = "Ñ¡Ôñ»úÐµ";
                colMaterialChoice.Width = 100;
                DevComponents.DotNetBar.Controls.DataGridViewTextBoxDropDownColumn colMaterial = new DevComponents.DotNetBar.Controls.DataGridViewTextBoxDropDownColumn();
                colMaterial.HeaderText = "»úÐµÃû³Æ";
                colMaterial.Width = 180;
                DevComponents.DotNetBar.Controls.DataGridViewIntegerInputColumn colMaterialNumber = new DevComponents.DotNetBar.Controls.DataGridViewIntegerInputColumn();
                colMaterialNumber.HeaderText = "ÊýÁ¿";
                colMaterialNumber.Width = 180;
             // DevComponents.DotNetBar.Controls.DataGridViewTextBoxDropDownColumn colMaterialRemark = new DevComponents.DotNetBar.Controls.DataGridViewTextBoxDropDownColumn();
               // colMaterialRemark.HeaderText = "¹æ¸ñ";
                //colMaterialRemark.Width = 150;
                DevComponents.DotNetBar.Controls.DataGridViewCheckBoxXColumn colMaterialDelete = new DevComponents.DotNetBar.Controls.DataGridViewCheckBoxXColumn();
                colMaterialDelete.HeaderText = "É¾³ýÐÐ";
                colMaterialDelete.Width = 60;
                Dgv_FS_Machine.Columns.Add(colMaterialChoice);
                Dgv_FS_Machine.Columns.Add(colMaterial);
                Dgv_FS_Machine.Columns.Add(colMaterialNumber);
               // Dgv_FS_Machine.Columns.Add(colMaterialRemark);
                Dgv_FS_Machine.Columns.Add(colMaterialDelete);
                Dgv_FS_Machine.Rows.Add();

                object[] strMaterial = new object[] { "´¸×Ó", "µ¥Í·°âÊÖ", "Ô²ÅÌ¾â", "Æ½ÅÙ", "ÊÖµç×ê", "Ì¨×ê", "ÊÖÌáµç¾â", "ÊÖÌáµçÅÙ", "Ñ¹ÅÙ", "»î¶¯°âÊÖ", "ÊÖµç×ê", "¿ÕÑ¹»ú", "¸ÖË¿Ç¯", "Ä«¶·¡¢·ÛÏß´ø", "É°ÂÖÇÐ¸î»ú", "ÁãÅä¼þºÍ¹¤¾ßÏä", "Ë®×¼ÒÇ", "¼¤¹â´¹×¼ÒÇ", "Ë®Æ½³ß", "¸Ö¾í³ß", "Ö±³ß", "¿¿³ß", "Èû¹æ" };
               // string[] strNumber = new string[] { "         ¸ö", "         m", "          ¸ö", "           m2", "      ¸ö", "         m" };
                for (int i = 0; i < strMaterial.Length; i++)
                {
                    DevComponents.DotNetBar.ButtonItem btnItem = new DevComponents.DotNetBar.ButtonItem();
                    btnItem.Text = (string)strMaterial[i];
                    btnItem.Click += new System.EventHandler(delegate(object sender1, System.EventArgs args)
                    {

                        int RowNum = Dgv_FS_Machine.CurrentRow.Index;
                        Dgv_FS_Machine.Rows[RowNum].Cells[1].Value = btnItem.Text;
                        /*  for (int j = 0; j < strMaterial.Length; j++)
                           {
                            if (btnItem.Text == strMaterial[j].ToString())
                               {
                                   Dgv_FS_Machine.Rows[RowNum].Cells[2].Value = strNumber[j];
                                   break;
                               }
                           }
                       */
                        Dgv_FS_Machine.Refresh();
                    });
                    colMaterialChoice.SubItems.Add(btnItem);
                }
            }
            #endregion
        }

        private void btnDeleteRow_Click(object sender, EventArgs e)
        {
            if (st_FS_1.SelectedTabIndex == 2)
            {
                foreach (DataGridViewRow row in this.Dgv_FS_Machine.Rows)
                {
                    if (row.Cells[3].Value != null && Convert.ToBoolean(row.Cells[3].Value) == true)
                    {
                        this.Dgv_FS_Machine.Rows.Remove(row);
                    }
                }
            }
            if (st_FS_1.SelectedTabIndex == 1)
            {
                foreach (DataGridViewRow row in this.Dgv_FS_Staff.Rows)
                {
                    if (row.Cells[3].Value != null && Convert.ToBoolean(row.Cells[3].Value) == true)
                    {
                        this.Dgv_FS_Staff.Rows.Remove(row);
                    }
                }
            }
        }

        
        private void btnSubmit_Click(object sender, EventArgs e)
        {
            #region  //»ñÈ¡Ä£°åµÄÄÚÈÝ
            object[] obj = new object[] { };
            string templatename = "Ä£°åÑ¡Ôñ";
            Framework.Entity.Template templatetemp = new Framework.Entity.Template();
            System.Collections.ArrayList templateList = contentService.GetContentTemplateByTitle(chaptertemp.Title);
            
            #endregion
            System.Collections.ArrayList array = new System.Collections.ArrayList();
            System.Collections.ArrayList array1 = new System.Collections.ArrayList();
            System.Collections.ArrayList array2 = new System.Collections.ArrayList();

            for (int i = 0; i < Dgv_FS_Machine.Rows.Count; i++)
            {
                if (Dgv_FS_Machine.Rows[i].Cells[1].Value != null)
                {
                    array2.Add(new object[] { i + 1, Dgv_FS_Machine.Rows[i].Cells[1].Value, Dgv_FS_Machine.Rows[i].Cells[2].Value });
                }
            }
            for (int i = 0; i < Dgv_FS_Staff.Rows.Count; i++)
            {
                if (Dgv_FS_Staff.Rows[i].Cells[1].Value != null)
                {
                    array1.Add(new object[] { i + 1, Dgv_FS_Staff.Rows[i].Cells[1].Value, Dgv_FS_Staff.Rows[i].Cells[2].Value });
                }
            }

            array.Add(array1);
            array.Add(array2);

            string data1_1, data1_2, data1_3, data1_5, data1_6;
            double data1_4, data1_7, data1_8;
            string str1_1;

            //Áº
            data1_1 = cB_FS_1CZJ.Text;
            data1_2 = cB_FS_1GGLX.Text;
            data1_3 = cB_FS_1MBLX.Text;
            data1_4 = dI_FS_1MBHD.Value;
            data1_5 = cB_FS_1DBZC.Text;
            data1_6 = cB_FS_1JMLX.Text;
            data1_7 = dI_FS_1FMK.Value;
            data1_8 = dI_FS_1FMG.Value;

            if (cB_FS_1DBZC.SelectedIndex != 0)
            {
                str1_1 = data1_6 + data1_5;
            }
            else {
                str1_1 = data1_7 + "mm" + "¡Á" + data1_8 + "mm" + data1_5;
            }

            //°å
            string data2_1, data2_2, data2_3, data2_5, data2_6;
            double data2_4, data2_7, data2_8;
            string str2_1;

            data2_1 = cB_FS_2CZJ.Text;
            data2_2 = cB_FS_2GGLX.Text;
            data2_3 = cB_FS_2MBLX.Text;
            data2_4 = dI_FS_2MBHD.Value;
            data2_5 = cB_FS_2DBZC.Text;
            data2_6 = cB_FS_2JMLX.Text;
            data2_7 = dI_FS_2FMK.Value;
            data2_8 = dI_FS_2FMG.Value;

            if (cB_FS_2DBZC.SelectedIndex != 0)
            {
                str2_1 = data2_6 + data2_5;
            }
            else
            {
                str2_1 = data2_7 + "mm" + "¡Á" + data2_8 + "mm" + data2_5;
            }

            obj = new object[] { data1_1, data1_2, data1_3, data1_4, str1_1, data2_1, data2_2, data2_3, data2_4, str2_1 };

            foreach (Framework.Entity.Template template in templateList)
            {
                if (template.Title == templatename)
                {
                    templatetemp = template;
                    break;
                }
            }

            CreateModuleIntance(templatetemp, array, @class, obj);
            this.Close();
        }
        
        private void st_FS_1_SelectedTabChanged(object sender, DevComponents.DotNetBar.SuperTabStripSelectedTabChangedEventArgs e)
        {
            if (st_FS_1.SelectedTabIndex == 0)
            {
                btnAddRow.Visible = btnDeleteRow.Visible = false;
            }
            else
            {
                btnAddRow.Visible = btnDeleteRow.Visible = true;
            }
        }

        
        


    }
}